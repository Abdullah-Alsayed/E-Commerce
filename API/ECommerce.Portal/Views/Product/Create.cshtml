@using ECommerce.BLL.Features.Products.Dtos
@using ECommerce.BLL.Features.Products.Requests
@using ECommerce.Portal.ViewModels
@model CreateProductViewModel
@inject IStringLocalizer<ProductController> _Localizer;
@inject ILocalizationManger _localizationManger;

@{
    ViewData["Title"] = "Product Add";
}

@section VendorStyles {
    <link rel="stylesheet" href="~/vendor/libs/quill/typography.css">
    <link rel="stylesheet" href="~/vendor/libs/quill/katex.css">
    <link rel="stylesheet" href="~/vendor/libs/quill/editor.css">
    <link rel="stylesheet" href="~/vendor/libs/select2/select2.css">
    <link rel="stylesheet" href="~/vendor/libs/dropzone/dropzone.css">
    <link rel="stylesheet" href="~/vendor/libs/flatpickr/flatpickr.css">
    <link rel="stylesheet" href="~/vendor/libs/tagify/tagify.css" />
}
@section VendorScripts {
    <script src="~/vendor/libs/quill/katex.js"></script>
    <script src="~/vendor/libs/quill/quill.js"></script>
    <script src="~/vendor/libs/select2/select2.js"></script>
    <script src="~/vendor/libs/dropzone/dropzone.js"></script>
    <script src="~/vendor/libs/jquery-repeater/jquery-repeater.js"></script>
    <script src="~/vendor/libs/flatpickr/flatpickr.js"></script>
    <script src="~/vendor/libs/tagify/tagify.js"></script>

}

@section PageScripts {
    <script src="~/js/app-ecommerce-product-add.js"></script>
}

@* ************** Content ************** *@
<div class="app-ecommerce">

    <!-- Add Product -->
    <div class="d-flex flex-column flex-md-row justify-content-between align-items-start align-items-md-center mb-3">

        <div class="d-flex flex-column justify-content-center">
            <h4 class="mb-1 mt-3">Add a new Product</h4>
            <p>Orders placed across your store</p>
        </div>
        <div class="d-flex align-content-center flex-wrap gap-3">
            <button type="submit" class="btn btn-primary">Save</button>
        </div>
    </div>

    <div class="row">

        <!-- First column-->
        <div class="col-12 col-lg-8">
            <!-- Product Information -->
            <div class="card mb-4">
                <div class="card-header">
                    <h5 class="card-tile mb-0">Product information</h5>
                </div>
                <div class="card-body">
                    <div class="form-floating form-floating-outline mb-4">
                        <input type="text" class="form-control" id="@nameof(CreateProductRequest.Title)" placeholder="Product title" name="@nameof(CreateProductRequest.Title)" aria-label="@nameof(CreateProductRequest.Title)">
                        <label for="@nameof(CreateProductRequest.Title)">@_Localizer[Constants.EntityKeys.Name]</label>
                    </div>

                    <div class="row mb-3">
                        <div class="col">
                            <div class="form-floating form-floating-outline">
                                <input type="text" class="form-control" id="@nameof(CreateProductRequest.Code)" placeholder="00000" name="@nameof(CreateProductRequest.Code)" aria-label="@nameof(CreateProductRequest.Code)">
                                <label for="@nameof(CreateProductRequest.Code)">@_Localizer[Constants.EntityKeys.Code]</label>
                            </div>
                        </div>
                        <div class="col">
                            <div class="form-floating form-floating-outline">
                                <input type="text" class="form-control" id="@nameof(CreateProductRequest.Barcode)" placeholder="0123-4567" name="@nameof(CreateProductRequest.Barcode)" aria-label="@nameof(CreateProductRequest.Barcode)">
                                <label for="@nameof(CreateProductRequest.Barcode)">@_Localizer[Constants.EntityKeys.Barcode]</label>
                            </div>
                        </div>
                    </div>
                    <!-- Comment -->
                    <div>
                        <label class="form-label">@_Localizer[Constants.EntityKeys.Description] <span class="text-muted">(Optional)</span></label>
                        <div class="form-control p-0 pt-1">
                            <div class="comment-toolbar border-0 border-bottom">
                                <div class="d-flex justify-content-start">
                                    <span class="ql-formats me-0">
                                        <button class="ql-bold"></button>
                                        <button class="ql-italic"></button>
                                        <button class="ql-underline"></button>
                                        <button class="ql-list" value="ordered"></button>
                                        <button class="ql-list" value="bullet"></button>
                                        <button class="ql-link"></button>
                                        <button class="ql-image"></button>
                                    </span>
                                </div>
                            </div>
                            <div class="comment-editor border-0 pb-1" id="@nameof(CreateProductRequest.Description)" name="@nameof(CreateProductRequest.Description)">
                            </div>

                        </div>
                    </div>
                </div>
            </div>
            <!-- /Product Information -->
            <!-- Media -->
            <div class="card mb-4">
                <div class="card-header d-flex justify-content-between align-items-center">
                    <h5 class="mb-0 card-title">Media</h5>
                    <a href="javascript:void(0);" class="fw-medium">Add media from URL</a>
                </div>
                <div class="card-body">
                    <form action="/upload" class="dropzone needsclick" id="dropzone-basic">
                        <div class="dz-message needsclick my-5">
                            Drag and drop your image here
                            <small class="text-muted d-block fs-6 my-2">or</small>
                            <span class="needsclick btn btn-outline-primary d-inline" id="btnBrowse">Browse image</span>
                        </div>
                        <div class="fallback">
                            <input name="file" type="file" />
                        </div>
                    </form>
                </div>
            </div>
            <!-- /Media -->

            <!-- Variants -->
            <div class="card mb-4">
                <div class="card-header">
                    <h5 class="card-title mb-0">Variants</h5>
                </div>
                <div class="card-body">
                    <form class="form-repeater">
                        <div data-repeater-list="group-a">
                            <div data-repeater-item>
                                <div class="row mb-3 mb-sm-0">
                                    <div class="mb-3 col-sm-4">
                                        <div class="form-floating form-floating-outline">
                                            <select id="select2Basic" class="select2 form-select" data-placeholder="Option" data-allow-clear="true">
                                                <option value="">Option</option>
                                                <option value="size">Size</option>
                                                <option value="color">Color</option>
                                                <option value="weight">Weight</option>
                                                <option value="smell">Smell</option>
                                            </select>
                                            <label for="select2Basic">Option</label>
                                        </div>
                                    </div>
                                    <div class="mb-3 col-sm-8">
                                        <div class="form-floating form-floating-outline">
                                            <input type="text" id="form-repeater-1-2" class="form-control" placeholder="Enter size">
                                            <label for="form-repeater-1-2">Value</label>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div>
                            <button class="btn btn-primary" data-repeater-create>
                                Add another option
                            </button>
                        </div>
                    </form>
                </div>
            </div>
            <!-- /Variants -->

        </div>
        <!-- /Second column -->
        <!-- Second column -->
        <div class="col-12 col-lg-4">
            <!-- Pricing Card -->
            <div class="card mb-4">
                <div class="card-header">
                    <h5 class="card-title mb-0">Pricing</h5>
                </div>
                <div class="card-body">
                    <!-- Base Price -->
                    <div class="form-floating form-floating-outline mb-4">
                        <input type="number" class="form-control" id="@nameof(CreateProductRequest.Price)" placeholder="Price" name="@nameof(CreateProductRequest.Price)" aria-label="@nameof(CreateProductRequest.Price)">
                        <label for="@nameof(CreateProductRequest.Price)">@_Localizer[Constants.EntityKeys.Price]</label>
                    </div>

                    <!-- Discounted Price -->
                    <div class="form-floating form-floating-outline mb-4">
                        <input type="number" class="form-control" id="@nameof(CreateProductRequest.DiscountLabel)" placeholder="Discounted Price" name="@nameof(CreateProductRequest.DiscountLabel)" aria-label="@nameof(CreateProductRequest.DiscountLabel)">
                        <label for="@nameof(CreateProductRequest.DiscountLabel)">@_Localizer[Constants.EntityKeys.Description]</label>
                    </div>
                    <!-- Charge tax check box -->
                    <div class="form-check mb-2">
                        <input class="form-check-input" type="checkbox" value="" id="price-charge-tax" checked>
                        <label class="form-check-label" for="price-charge-tax">
                            Charge tax on this product
                        </label>
                    </div>
                    <!-- Instock switch -->
                    <div class="d-flex justify-content-between align-items-center border-top pt-3">
                        <p class="mb-0">In stock</p>
                        <div class="w-25 d-flex justify-content-end">
                            <label class="switch switch-primary  me-4 pe-2">
                                <input type="checkbox" class="switch-input" checked="">
                                <span class="switch-toggle-slider">
                                    <span class="switch-on">
                                        <span class="switch-off"></span>
                                    </span>
                                </span>
                            </label>
                        </div>
                    </div>
                </div>
            </div>
            <!-- /Pricing Card -->
            
            <!-- Organize Card -->
            <div class="card mb-4">
                <div class="card-header">
                    <h5 class="card-title mb-0">Organize</h5>
                </div>
                <div class="card-body">
                    <!-- Unit -->
                    <div class="mb-3 col ecommerce-select2-dropdown">
                        <div class="form-floating form-floating-outline">
                            <select id="@nameof(CreateProductRequest.UnitID)" class="select2 form-select" data-placeholder="Select Unit" name="@nameof(CreateProductRequest.UnitID)" required>
                                <option value="">Select Unit</option>
                                @foreach (var unit in Model.Units)
                                {
                                    <option value="@unit.Id">@unit.Name</option>
                                }
                            </select>
                            <label for="@nameof(CreateProductRequest.UnitID)">@_Localizer[Constants.EntityKeys.Unit]</label>
                        </div>
                    </div>

                    <!-- Category -->
                    <div class="mb-4 col ecommerce-select2-dropdown">
                        <div class="form-floating form-floating-outline">
                            <select id="@nameof(CreateProductRequest.CategoryID)" class="select2 form-select" data-placeholder="Select Category" name="@nameof(CreateProductRequest.CategoryID)" required>
                                <option value="">Select Category</option>
                                @foreach (var category in Model.Categories)
                                {
                                    <option value="@category.Id">@category.Name</option>
                                }
                            </select>
                            <label for="@nameof(CreateProductRequest.CategoryID)">@_Localizer[Constants.EntityKeys.Category]</label>
                        </div>
                    </div>

                    <!-- SubCategory -->
                    <div class="mb-4 col ecommerce-select2-dropdown" id="subCategoryContainer">
                        <div class="form-floating form-floating-outline">
                            <select id="@nameof(CreateProductRequest.SubCategoryID)" class="select2 form-select" data-placeholder="Select SubCategory" name="@nameof(CreateProductRequest.SubCategoryID)">
                                <option value="">Select SubCategory</option>
                            </select>
                            <label for="@nameof(CreateProductRequest.SubCategoryID)">@_Localizer[Constants.EntityKeys.SubCategory]</label>
                        </div>
                    </div>

                    <!-- Brand -->
                    <div class="mb-4 col ecommerce-select2-dropdown">
                        <div class="form-floating form-floating-outline">
                            <select id="@nameof(CreateProductRequest.BrandID)" class="select2 form-select" data-placeholder="Select Brand" name="@nameof(CreateProductRequest.BrandID)">
                                <option value="">Select Brand</option>
                                @foreach (var brand in Model.Brands)
                                {
                                    <option value="@brand.Id">@brand.Name</option>
                                }
                            </select>
                            <label for="@nameof(CreateProductRequest.BrandID)">@_Localizer[Constants.EntityKeys.Brand]</label>
                        </div>
                    </div>

                    <!-- Tags -->
                    <div class="mb-3">
                        <div class="form-floating form-floating-outline">
                            <input id="@nameof(CreateProductRequest.TagIDs)" name="@nameof(CreateProductRequest.TagIDs)" class="form-control h-auto" placeholder="select technologies" value="">
                            <label for="@nameof(CreateProductRequest.TagIDs)">@_Localizer[Constants.EntityKeys.Tags]</label>
                            <input type="hidden" id="tagsWhiteList" value="@string.Join(",",Model.Tags.Select(x=> x.Name).ToList())">
                        </div>
                    </div>
                </div>
            </div>
            <!-- /Organize Card -->
        </div>
        <!-- /Second column -->
    </div>
</div>
